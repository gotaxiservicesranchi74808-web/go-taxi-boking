<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GO TAXI SERVICES â€“ Booking View</title>

<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
h2{color:#1e88e5}
.card{background:#fff;padding:15px;border-radius:8px;margin-bottom:15px;box-shadow:0 0 5px rgba(0,0,0,.1)}
.btn{padding:8px 12px;background:#1e88e5;color:#fff;border:none;border-radius:5px;cursor:pointer;margin-right:5px}
.btn:hover{background:#1565c0}
small{color:#555}
</style>
</head>

<body>

<h2>ðŸ“‹ All Bookings</h2>
<div id="list">Loadingâ€¦</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz8KlhAXfQiAPqnvad-vNgtnD_SM4CEbZudneBRCDmoF8v3tPvTvvDwGCGXQzDw7nkiEw/exec";

fetch(SCRIPT_URL)
.then(r => r.json())
.then(bookings => {

  if (!Array.isArray(bookings) || bookings.length === 0) {
    document.getElementById("list").innerHTML = "<b>No Booking Found</b>";
    return;
  }

  let html = "";

  bookings.reverse().forEach(b => {

    html += `
    <div class="card">
      <b>Trip ID:</b> ${b.tripId}<br>
      <b>Trip:</b> ${b.tripType}<br>
      <b>Date:</b> ${formatDate(b.pickupDate)}<br>
      <b>Time:</b> ${b.pickupTime}<br><br>

      <b>Customer:</b> ${b.customerName} (${b.customerPhone})<br>
      <b>Driver:</b> ${b.driverName} (${b.driverPhone})<br><br>

      <b>Route:</b><br>
      ${b.pickup} â†’ ${b.goingOn} â†’ ${b.drop}<br><br>

      <b>Cab:</b> ${b.cabType}<br>
      <b>Cab No:</b> ${b.cabNo}<br><br>

      <b>Total:</b> â‚¹${b.totalAmount || "-"} |
      <b>Advance:</b> â‚¹${b.advance || 0} |
      <b>Balance:</b> â‚¹${b.balance || "-"}<br>
      <b>Driver Collection:</b> â‚¹${b.driverCollection || "-"}<br><br>

      <button class="btn" onclick='shareCustomer(${JSON.stringify(b)})'>Customer</button>
      <button class="btn" onclick='shareDriver(${JSON.stringify(b)})'>Driver</button>
    </div>
    `;
  });

  document.getElementById("list").innerHTML = html;
});

function formatDate(d){
  if(!d) return "";
  return new Date(d).toLocaleDateString("en-IN");
}

function shareCustomer(b){
let msg=`GO TAXI SERVICES
Booking ID: ${b.tripId}
Trip: ${b.tripType}

Pickup Date: ${formatDate(b.pickupDate)}
Pickup Time: ${b.pickupTime}

Route:
${b.pickup} â†’ ${b.goingOn} â†’ ${b.drop}

Cab: ${b.cabType}
Cab No: ${b.cabNo}

Total Fare: â‚¹${b.totalAmount}
Advance: â‚¹${b.advance}
Balance: â‚¹${b.balance}

Driver: ${b.driverName} (${b.driverPhone})

Contact: 8434143546
Website: https://gotaxiservices.com
Review: https://g.page/r/CbVg3mitMnAEEBM/review`;

window.open("https://wa.me/?text="+encodeURIComponent(msg));
}

function shareDriver(b){
let msg=`GO TAXI SERVICES â€“ DRIVER TRIP
Booking ID: ${b.tripId}

Pickup Date: ${formatDate(b.pickupDate)}
Pickup Time: ${b.pickupTime}

Customer: ${b.customerName} (${b.customerPhone})

Route:
${b.pickup} â†’ ${b.goingOn} â†’ ${b.drop}

Cab: ${b.cabType}
Cab No: ${b.cabNo}

Your Collection: â‚¹${b.driverCollection}

Office: 8434143546`;

window.open("https://wa.me/?text="+encodeURIComponent(msg));
}
</script>

</body>
</html>
