<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GO TAXI SERVICES â€“ Booking View</title>

<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
h2{color:#1e88e5}
table{width:100%;border-collapse:collapse;background:#fff}
th,td{border:1px solid #ccc;padding:8px;font-size:14px}
th{background:#1e88e5;color:#fff}
button{padding:5px 8px;margin:2px;background:#1e88e5;color:#fff;border:none;border-radius:4px;cursor:pointer}
button:hover{background:#1565c0}
</style>
</head>

<body>

<h2>ðŸš– GO TAXI SERVICES â€“ Booking View</h2>

<table id="bookingTable">
<thead>
<tr>
<th>Trip ID</th>
<th>Trip</th>
<th>Date</th>
<th>Time</th>
<th>Route</th>
<th>Cab</th>
<th>Customer</th>
<th>Driver</th>
<th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>

"https://script.google.com/macros/s/AKfycbz8KlhAXfQiAPqnvad-vNgtnD_SM4CEbZudneBRCDmoF8v3tPvTvvDwGCGXQzDw7nkiEw/exec";

fetch(SCRIPT_URL)
.then(res => res.json())
.then(result => {

  const rows = result.data;
  const tbody = document.querySelector("#bookingTable tbody");

  if(!rows || rows.length <= 1){
    tbody.innerHTML = "<tr><td colspan='9'>NO BOOKING FOUND</td></tr>";
    return;
  }

  for(let i=1;i<rows.length;i++){
    const r = rows[i];

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${r[0]}</td>
      <td>${r[1]}</td>
      <td>${formatDate(r[2])}</td>
      <td>${r[3]}</td>
      <td>${r[6]} â†’ ${r[7]} â†’ ${r[8]}</td>
      <td>${r[4]} (${r[5]})</td>
      <td>${r[9]}<br>${r[10]}</td>
      <td>${r[11]}<br>${r[12]}</td>
      <td>
        <button onclick='shareCustomer(${JSON.stringify(r)})'>Customer</button>
        <button onclick='shareDriver(${JSON.stringify(r)})'>Driver</button>
      </td>
    `;
    tbody.appendChild(tr);
  }
})
.catch(err=>{
  document.querySelector("#bookingTable tbody")
  .innerHTML="<tr><td colspan='9'>ERROR LOADING DATA</td></tr>";
});

/* DATE FIX */
function formatDate(d){
  if(!d) return "";
  const dt = new Date(d);
  return dt.toLocaleDateString("en-IN");
}

/* SHARE CUSTOMER */
function shareCustomer(r){
let msg=`GO TAXI SERVICES
Booking ID: ${r[0]}
Trip: ${r[1]}

Pickup Date: ${formatDate(r[2])}
Pickup Time: ${r[3]}

Route:
${r[6]} â†’ ${r[7]} â†’ ${r[8]}

Cab: ${r[4]}
Cab No: ${r[5]}

Total Fare: â‚¹${r[13]}
Advance: â‚¹${r[14]}
Balance: â‚¹${r[15]}

Driver: ${r[11]} (${r[12]})

Contact: 8434143546
Website: https://gotaxiservices.com
Review: https://g.page/r/CbVg3mitMnAEEBM/review`;

window.open("https://wa.me/?text="+encodeURIComponent(msg));
}

/* SHARE DRIVER */
function shareDriver(r){
let msg=`GO TAXI SERVICES â€“ DRIVER TRIP
Booking ID: ${r[0]}

Pickup Date: ${formatDate(r[2])}
Pickup Time: ${r[3]}

Customer: ${r[9]} (${r[10]})

Route:
${r[6]} â†’ ${r[7]} â†’ ${r[8]}

Cab: ${r[4]}
Cab No: ${r[5]}

Your Collection: â‚¹${r[16]}

Office: 8434143546`;

window.open("https://wa.me/?text="+encodeURIComponent(msg));
}
</script>

</body>
</html>

