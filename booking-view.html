<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GO TAXI SERVICES â€“ Booking View</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
h2{
  color:#1e88e5;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
}
th, td{
  border:1px solid #ddd;
  padding:8px;
  text-align:left;
  font-size:14px;
}
th{
  background:#1e88e5;
  color:#fff;
}
tr:nth-child(even){
  background:#f9f9f9;
}
.btn{
  padding:5px 8px;
  background:#25D366;
  color:#fff;
  text-decoration:none;
  border-radius:4px;
  font-size:12px;
}
.btn-driver{
  background:#1e88e5;
}
.center{
  text-align:center;
  margin-top:20px;
}
</style>
</head>

<body>

<h2>ðŸš– GO TAXI SERVICES â€“ Booking View</h2>

<table>
<thead>
<tr>
  <th>Trip ID</th>
  <th>Trip</th>
  <th>Pickup Date</th>
  <th>Pickup Time</th>
  <th>Route</th>
  <th>Cab</th>
  <th>Customer</th>
  <th>Driver</th>
  <th>Amount</th>
  <th>Share</th>
</tr>
</thead>

<tbody id="bookingBody">
<tr>
  <td colspan="10" class="center">Loading bookings...</td>
</tr>
</tbody>
</table>

<script>
const SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbz8KlhAXfQiAPqnvad-vNgtnD_SM4CEbZudneBRCDmoF8v3tPvTvvDwGCGXQzDw7nkiEw/exec";

fetch(SCRIPT_URL)
  .then(res => res.json())
  .then(result => {

    if (!result.data || result.data.length <= 1) {
      document.getElementById("bookingBody").innerHTML =
        "<tr><td colspan='10'>No booking found</td></tr>";
      return;
    }

    const rows = result.data;
    let html = "";

    for (let i = 1; i < rows.length; i++) {
      const r = rows[i];

      const tripId = r[0];
      const tripType = r[1];
      const pickupDate = r[2] ? r[2].toString().split("T")[0] : "";
      const pickupTime = r[3] || "";
      const cab = `${r[4]} (${r[5]})`;
      const route = `${r[6]} â†’ ${r[7]} â†’ ${r[8]}`;
      const customer = `${r[9]} (${r[10]})`;
      const driver = `${r[11]} (${r[12]})`;
      const amount = r[13] || "â€”";

      const customerMsg =
`GO TAXI SERVICES
Booking ID: ${tripId}
Trip: ${tripType}

Pickup Date: ${pickupDate}
Pickup Time: ${pickupTime}

Route:
${route}

Cab: ${cab}

Total Fare: â‚¹${r[13] || ""}
Advance: â‚¹${r[14] || 0}
Balance: â‚¹${r[15] || ""}

Driver: ${r[11]} (${r[12]})

Contact: 8434143546
Website: https://gotaxiservices.com
Map: https://share.google/vI2VbDezpUTvdtzs3
Review: https://g.page/r/CbVg3mitMnAEEBM/review`;

      const driverMsg =
`GO TAXI SERVICES â€“ DRIVER TRIP
Booking ID: ${tripId}

Pickup Date: ${pickupDate}
Pickup Time: ${pickupTime}

Customer: ${r[9]} (${r[10]})

Route:
${route}

Cab: ${cab}

Your Collection: â‚¹${r[16] || ""}

Office: 8434143546`;

      html += `
      <tr>
        <td>${tripId}</td>
        <td>${tripType}</td>
        <td>${pickupDate}</td>
        <td>${pickupTime}</td>
        <td>${route}</td>
        <td>${cab}</td>
        <td>${customer}</td>
        <td>${driver}</td>
        <td>â‚¹${amount}</td>
        <td>
          <a class="btn"
             target="_blank"
             href="https://wa.me/91${r[10]}?text=${encodeURIComponent(customerMsg)}">
             Customer
          </a>
          <br><br>
          <a class="btn btn-driver"
             target="_blank"
             href="https://wa.me/91${r[12]}?text=${encodeURIComponent(driverMsg)}">
             Driver
          </a>
        </td>
      </tr>
      `;
    }

    document.getElementById("bookingBody").innerHTML = html;
  })
  .catch(err => {
    console.error(err);
    document.getElementById("bookingBody").innerHTML =
      "<tr><td colspan='10'>Error loading data</td></tr>";
  });
</script>

</body>
</html>

